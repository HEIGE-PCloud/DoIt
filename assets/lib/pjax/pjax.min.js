(()=>{"use strict";var t={d:(e,o)=>{for(var i in o)t.o(o,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:o[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function o(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function i(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}t.d(e,{default:()=>v});var s=new WeakSet,r=new WeakSet;function n(){window.sessionStorage.setItem(this.sessionKey,JSON.stringify(this.state))}function a(t=window.history.state){i(this,s,n).call(this);const e=`${this.idPrefix}_${this.count}`;this.count+=1;const o={...t||{},[this.historyKey]:e};return this.sessionKey=e,this.state=o,o}const c={async innerHTML(t,e){t.innerHTML=e.innerHTML},async textContent(t,e){t.textContent=e.textContent},async innerText(t,e){t.innerText=e.innerText},async attributes(t,e){let o=t.getAttributeNames();e.getAttributeNames().forEach((i=>{t.setAttribute(i,e.getAttribute(i)),o=o.filter((t=>t!==i))})),o.forEach((e=>{t.removeAttribute(e)}))},async replaceWith(t,e){t.replaceWith(e)}};c.default=c.replaceWith;const l=c,h=t=>{let e=t;const o=[...document.links];for(;!o.includes(e);){const t=e.parentElement;if(!t)return null;e=t}return e};class u{constructor(t){o(this,"pjax",void 0),this.pjax=t}onLinkOpen(t,e){t.defaultPrevented||(t instanceof MouseEvent||t instanceof KeyboardEvent)&&(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)||e.origin===window.location.origin&&(t.preventDefault(),this.pjax.loadURL(e.href).catch((()=>{})))}register(){document.addEventListener("click",(t=>{const e=h(t.target);e&&this.onLinkOpen(t,e)})),document.addEventListener("keyup",(t=>{if("Enter"!==t.key)return;const e=h(t.target);e&&this.onLinkOpen(t,e)}))}}async function d(t,e={}){var o;const{selectors:i,switches:s,timeout:r}={...this.options,...e},n={},a=new URL(t,document.URL);n.targetURL=a.href;const c=(null===(o=this.abortController)||void 0===o?void 0:o.signal)||null;n.signal=c,n.selectors=i;const h=new Request(a.href,{headers:{"X-Requested-With":"Fetch","X-Pjax":"true","X-Pjax-Selectors":JSON.stringify(i)},signal:c});n.timeout=r;let u=null;r>0&&(u=window.setTimeout((()=>{var t;null===(t=this.abortController)||void 0===t||t.abort()}),r),n.timeoutID=u),this.fire("send",n);try{const t=await fetch(h).finally((()=>{window.clearTimeout(u)})),o=(new DOMParser).parseFromString(await t.text(),"text/html");n.switches=s;const r=await async function(t,{selectors:e,switches:o,signal:i}){if(null!=i&&i.aborted)throw new DOMException("Aborted switches","AbortError");let s=!1;const r=[];e.forEach((e=>{const i=t.querySelectorAll(e),n=document.querySelectorAll(e);if(i.length!==n.length)throw new DOMException(`Selector '${e}' does not select the same amount of nodes`,"IndexSizeError");n.forEach(((t,n)=>{!s&&document.activeElement&&t.contains(document.activeElement)&&(document.activeElement.blur(),s=!0);const a=(null==o?void 0:o[e])||l.default,c=Promise.resolve().then((()=>a(t,i[n]))).catch((()=>{}));r.push(c)}))}));const n=await Promise.race([Promise.all(r),new Promise(((t,e)=>{null==i||i.addEventListener("abort",(()=>{e(new DOMException("Aborted switches","AbortError"))}))}))]);return{focusCleared:s,outcomes:n}}(o,{selectors:i,switches:s,signal:c});n.switchResult=r;const d=new URL(t.url);d.hash=a.hash,window.location.href!==d.href&&window.history.pushState({},document.title,d.href),await this.preparePage(r,e)}catch(t){throw n.error=t,this.fire("error",n),t}finally{this.fire("complete",n)}this.fire("success",n)}const w=["application/ecmascript","application/javascript","application/x-ecmascript","application/x-javascript","text/ecmascript","text/javascript","text/javascript1.0","text/javascript1.1","text/javascript1.2","text/javascript1.3","text/javascript1.4","text/javascript1.5","text/jscript","text/livescript","text/x-ecmascript","text/x-javascript"];class p{constructor(t){this.signal=t}async exec(t){var e;if(null!==(e=this.signal)&&void 0!==e&&e.aborted)throw new DOMException("Execution aborted","AbortError");const o=t.eval().catch((()=>{}));t.blocking&&await o}}async function f(t,e={}){const o={...this.options,...e};if(t){var i,s;t.focusCleared&&(null===(s=document.querySelectorAll("[autofocus]")[0])||void 0===s||s.focus());const e=[...document.querySelectorAll(o.scripts)].filter((t=>t instanceof HTMLScriptElement));o.selectors.forEach((t=>{document.body.querySelectorAll(t).forEach((t=>{t.querySelectorAll("script").forEach((t=>{e.includes(t)||e.push(t)}))}))})),e.sort(((t,e)=>t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING||-1)),await async function(t,{signal:e}={}){if(null!=e&&e.aborted)throw new DOMException("Aborted execution","AbortError");const o=Array.from(t,(t=>new class{constructor(t){if(this.evaluable=!1,this.external=!1,this.target=t,!t.hasAttribute("src")&&!t.text)return;const e=t.type?t.type.trim():"text/javascript";if(w.includes(e))this.type="classic";else{if("module"!==e)return;this.type="module"}if(!t.noModule||"classic"!==this.type){if(t.hasAttribute("src")){const e=t.getAttribute("src");if(!e)return;this.external=!0;try{new URL(e,document.URL)}catch{return}}this.blocking=!0,("classic"!==this.type||this.external&&(t.hasAttribute("async")||t.hasAttribute("defer")))&&(this.blocking=!1),this.evaluable=!0}}eval(){return new Promise(((t,e)=>{const o=this.target,i=document.createElement("script");i.addEventListener("error",e),o.getAttributeNames().forEach((t=>{i.setAttribute(t,o.getAttribute(t))})),i.text=o.text,this.external&&(i.hasAttribute("async")||(i.async=!1),i.defer=!1),document.contains(o)?o.replaceWith(i):(document.head.append(i),this.external?i.addEventListener("load",(()=>i.remove())):i.remove()),this.external?i.addEventListener("load",t):t()}))}}(t))).filter((t=>t.evaluable)),i=new p(e),s=o.reduce(((t,e)=>e.external?Promise.all([t,i.exec(e)]):t.then((()=>i.exec(e)))),Promise.resolve());return Promise.race([s,new Promise(((t,o)=>{null==e||e.addEventListener("abort",(()=>{o(new DOMException("Aborted execution","AbortError"))}))}))])}(e,{signal:null===(i=this.abortController)||void 0===i?void 0:i.signal})}const{scrollTo:r}=o;if(!1!==r){let e=!!t&&[0,0];if(Array.isArray(r))e=r;else if("number"==typeof r)e=[window.scrollX,r];else{const t=decodeURIComponent(window.location.hash.slice(1));if(t){const o=document.getElementById(t)||document.getElementsByName(t)[0];o&&(o.scrollIntoView(),e=!1)}}e&&window.scrollTo(e[0],e[1])}}async function m(t,e={}){var o;const i=new URL(t,document.URL);if(i.origin!==window.location.origin)throw new DOMException("Not same origin","SecurityError");this.storeScrollPosition();const s=new AbortController;null===(o=this.abortController)||void 0===o||o.abort(),this.abortController=s,i.pathname+i.search===this.location.pathname+this.location.search?(window.location.href!==i.href&&window.history.pushState({},document.title,i.href),await this.preparePage(null,e)):await this.switchDOM(t,e),this.history.pull(),this.location.href=window.location.href,this.abortController=null}class y{static reload(){window.location.reload()}constructor(t={}){o(this,"options",{defaultTrigger:!0,selectors:["title",".pjax"],switches:{},scripts:"script[data-pjax]",scrollTo:!0,scrollRestoration:!0,cacheMode:"default",timeout:0}),o(this,"history",new class{constructor(t,e=t){r.add(this),s.add(this),o(this,"idPrefix",void 0),o(this,"count",0),o(this,"historyKey",void 0),o(this,"sessionKey",void 0),o(this,"state",void 0),this.idPrefix=t,this.historyKey=e,window.history.replaceState(i(this,r,a).call(this),document.title)}push(t,e,o){window.history.pushState(i(this,r,a).call(this,t),e,o)}pull(){var t;i(this,s,n).call(this);const e=null===(t=window.history.state)||void 0===t?void 0:t[this.historyKey];e?(this.sessionKey=e,this.state=JSON.parse(window.sessionStorage.getItem(e))):window.history.replaceState(i(this,r,a).call(this),document.title)}}("pjax")),o(this,"location",new URL(window.location.href)),o(this,"abortController",null),o(this,"switchDOM",d),o(this,"preparePage",f),o(this,"weakLoadURL",m),Object.assign(this.options,t),this.options.scrollRestoration&&(window.history.scrollRestoration="manual",window.addEventListener("beforeunload",(()=>{window.history.scrollRestoration="auto"}))),this.options.defaultTrigger&&new u(this).register(),window.addEventListener("popstate",(t=>{if(this.storeScrollPosition(),this.history.pull(),null===t.state)return;const e={};this.options.scrollRestoration&&"scrollPos"in this.history.state&&(e.scrollTo=this.history.state.scrollPos),this.loadURL(window.location.href,e).catch((()=>{}))}))}storeScrollPosition(){this.history.state.scrollPos=[window.scrollX,window.scrollY]}fire(t,e){const o=new CustomEvent(`pjax:${t}`,{bubbles:!0,cancelable:!1,detail:{abortController:this.abortController,...e}});document.dispatchEvent(o)}async loadURL(t,e={}){try{await this.weakLoadURL(t,e)}catch(e){if("AbortError"===e.name)throw e;window.location.assign(t)}}}o(y,"switches",l);const v=y;self.Pjax=e.default})();
//# sourceMappingURL=pjax.min.js.map