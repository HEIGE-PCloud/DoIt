!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("artalk"),require("katex")):"function"==typeof define&&define.amd?define(["artalk","katex"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Artalk,e.katex)}(this,(function(e,t){"use strict";e.use((e=>{const n=e.getMarkedInstance();if(!n)return void console.log("[artalk-plugin-katex] no marked instance found");let r=0;const a=()=>`__atk_katext_id_${r++}__`,o={};function s(e){return e=(e=e.replace(/\$\$([\s\S]+?)\$\$/g,((e,t)=>{const n=a();return o[n]={type:"block",expression:t},n}))).replace(/\$([^\n]+?)\$/g,((e,t)=>{const n=a();return o[n]={type:"inline",expression:t},n}))}const i=new n.Renderer,l=i.listitem,c=i.paragraph,p=i.tablecell,d=i.codespan,u=i.text;i.listitem=(e,t,n)=>l(s(e),t,n),i.paragraph=e=>c(s(e)),i.tablecell=(e,t)=>p(s(e),t),i.codespan=e=>d(s(e)),i.text=e=>u(s(e)),e.markedReplacers.push((e=>e=e.replace(/(__atk_katext_id_\d+__)/g,((e,n)=>{const r=o[n],a=r.type;let s=r.expression;return s=s.replace(/<br\s*\/?>/gm,"\n"),t.renderToString(s,{displayMode:"block"===a})})))),n.use({renderer:i})}))}));